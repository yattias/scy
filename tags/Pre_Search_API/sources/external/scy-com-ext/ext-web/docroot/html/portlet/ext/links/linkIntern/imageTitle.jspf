		<c:if test="<%= sType != null && sType.equals(IGImage.class.getName()) %>">			
<%		
				List<IGFolder> folderList = (List<IGFolder>)request.getAttribute("folderList");
				IGFolder rootFolder = (IGFolder)request.getAttribute("rootFolder");	
				IGFolder parentFolder = (IGFolder)request.getAttribute("parentFolder");			
				List<IGImage> imageList = (List<IGImage>)request.getAttribute("imageList");
%>		
				<c:if test="<%= folderList != null %>">		
					<c:if test="<%= rootFolder.getFolderId() != parentFolder.getFolderId() %>">						
						<portlet:actionURL var="backFolder">
			                    <portlet:param name="struts_action" value="<%= struts_action %>" />
			                    <portlet:param name="entryId" value="<%= String.valueOf(entryId) %>" />
			                  	<portlet:param name="cmd" value="backFolder" />
			                  	<portlet:param name="rootFolderId" value="<%= String.valueOf(rootFolder.getFolderId()) %>" />
			                    <portlet:param name="folderId" value="<%= String.valueOf(parentFolder.getFolderId()) %>" />
			                  	<portlet:param name="sType" value="<%= sType %>" /> 
			                  	<portlet:param name="redirect" value="<%= redirect %>" /> 
			                  	<portlet:param name="className" value="<%= startResourceclassName %>" /> 
						</portlet:actionURL>
						
						<div style="text-align: left; padding:5px;" >		
								<img src="<%= themeDisplay.getURLPortal() %>/html/themes/classic/images/common/folder.png" class="icon"  /> <a href="<%= backFolder %>" <%= onClickHtml %>> ...</a>			
						</div>					
					</c:if>	
<%								
					for (int folderListCount = 0; folderListCount < folderList.size(); folderListCount++) {			
						IGFolder folderEntry = (IGFolder)folderList.get(folderListCount);	
						String folderTitle = folderEntry.getName();		

%>					
					<portlet:actionURL var="documentFolder">
		                    <portlet:param name="struts_action" value="<%= struts_action %>" />
		                    <portlet:param name="entryId" value="<%= String.valueOf(entryId) %>" />
		                  	<portlet:param name="cmd" value="choseFolder" />
		                  	<portlet:param name="rootFolderId" value="<%= String.valueOf(rootFolder.getFolderId()) %>" />
		                    <portlet:param name="folderId" value="<%= String.valueOf(folderEntry.getFolderId()) %>" />
		                  	<portlet:param name="sType" value="<%= sType %>" /> 
		                  	<portlet:param name="redirect" value="<%= redirect %>" /> 
		                  	<portlet:param name="className" value="<%= startResourceclassName %>" /> 
					</portlet:actionURL>
					
					<div style="text-align: left; padding:5px;" >		

							<img src="<%= themeDisplay.getURLPortal() %>/html/themes/classic/images/common/folder.png" class="icon"  /> 
							<a href="<%= documentFolder %>" <%= onClickHtml %>> 								
								 <%= folderTitle %>
							</a>			
					</div>
<%
					}
%>

				</c:if>
				<c:if test="<%= imageList != null %>">			
<%		
					for (int i = 0; i <imageList.size(); i++) {
						IGImage imageEntry = (IGImage)imageList.get(i);
					
						String title;
						boolean show = true;
						boolean linkExists= false;
						if(entryId.equals(imageEntry.getImageId())){
							show= false;
						}
						
					List<LinkEntry> linkExistsList = LinkEntryLocalServiceUtil.getService().getLinkEntry(String.valueOf(entryId), String.valueOf(imageEntry.getImageId()));
						if (!linkExistsList.isEmpty()) {
									linkExists = true;
						} 	
						
					title = imageEntry.getName();
	%>
	
	
					<portlet:actionURL var="imagePreview">
			                    <portlet:param name="struts_action" value="<%= struts_action %>" />
			                    <portlet:param name="entryId" value="<%= String.valueOf(entryId) %>" />
			                  	<portlet:param name="cmd" value="changePreview" />
			                    <portlet:param name="previewEntryId" value="<%= String.valueOf(imageEntry.getImageId()) %>" />
			                    <portlet:param name="rootFolderId" value="<%= String.valueOf(rootFolder.getFolderId()) %>" />
		                    <portlet:param name="folderId" value="<%= String.valueOf(parentFolder.getFolderId()) %>" />
			                  	<portlet:param name="sType" value="<%= sType %>" /> 
			                  	<portlet:param name="redirect" value="<%= redirect %>" /> 
			                  	<portlet:param name="className" value="<%= startResourceclassName %>" /> 
					</portlet:actionURL>
	
					<c:if test="<%= show && IGImagePermission.contains(permissionChecker, imageEntry, ActionKeys.VIEW) %>">
						 <div style="text-align: left; padding:5px;" >
								<c:if test="<%= !linkExists %>">
									<a href="<%= imagePreview %>" <%= onClickHtml %>>  
										<input type="radio" name="radio" value="<%= imageEntry.getImageId() %>" <%= checkedResource.equals(String.valueOf(imageEntry.getImageId())) ? " checked" : "" %>> 
										<img src="<%= themeDisplay.getURLPortal() %>/html/icons/image_gallery.png" class="icon"  />	
									</a>
									<a href="<%= imagePreview %>" <%= onClickHtml %>><%= title %></a>
								</c:if>
								<c:if test="<%= linkExists %>">
									<a href="<%= imagePreview %>" <%= onClickHtml %>>  
										<input type="radio" name="<%=imageEntry.getImageId() %>" DISABLED ="true" CHECKED="true" > 
										<img src="<%= themeDisplay.getURLPortal() %>/html/icons/image_gallery.png" class="icon"  />		
									</a>
									<a href="<%= imagePreview %>" <%= onClickHtml %>><%= title %></a>
								</c:if>
						</div>
					</c:if>             
<%
					}
%>
				</c:if>
			</c:if>