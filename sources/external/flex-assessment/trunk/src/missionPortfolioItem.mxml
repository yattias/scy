<?xml version="1.0" encoding="utf-8"?>
<s:NavigatorContent xmlns:fx="http://ns.adobe.com/mxml/2009" 
					xmlns:s="library://ns.adobe.com/flex/spark" 
					xmlns:mx="library://ns.adobe.com/flex/mx" width="100%" height="100%">
	
	<fx:Script>
		<![CDATA[
			import listeners.ToggleEvent;
			
			import mx.collections.ArrayCollection;
			
			[Bindable] public var allGood:Boolean = true;
			
			private var objectsToTile:ArrayCollection;
			private var studentName:String;
			
			public var studentIndex:Number;
			
			public function buildEloArray(xmlData:XML, studentName:String):Array {
				this.studentName = studentName;
				var counts:Array = new Array();
				var unassessedElos:Number = 0;
				var totElos:Number = 0;
				objectsToTile = new ArrayCollection();
				var tc:tileCell;
				for each (var object:XML in xmlData.elos.*) {
					if (object.name() == "elo") {
						totElos++;
						tc = new tileCell();
						tc.studentIndex = studentIndex;
						tc.cellTitle = object.catname;
						tc.cellAssess = parseStringToBool(object.assessed);
						if(tc.cellAssess) {
							unassessedElos++;
						}
						else {
							allGood = false;							
						}
						tc.cellGrade = object.grade;
						tc.eloid = object.@uri;
						objectsToTile.addItem(tc);
					}
				}
				
				counts.push(totElos);
				counts.push(unassessedElos);

				return counts;
			}
			
			private function buildTile():void {
				for each (var tcell:tileCell in objectsToTile) {
					dataTile.addElement(tcell);
				}
			}
			
			private function parseStringToBool( str:String ):Boolean {
				return Boolean( str == "true" );
			}
			
			protected function clickHandler(dir:String, stack:Number):void {
				var tEvent:ToggleEvent = new ToggleEvent(index.TOGGLE_COMMAND, true);
				tEvent.direction = dir;
				tEvent.selecTarget = stack;
				tEvent.portfolioToAssess = studentName;
				dispatchEvent(tEvent);
			}
		]]>
	</fx:Script>
	
	<s:VGroup width="100%" height="100%" horizontalAlign="center">
		<mx:Spacer height="10" />
		<s:TileGroup id="dataTile" width="{this.width-20}" height="100%" creationComplete="buildTile()" />
		<s:HGroup id="assessFooter" width="100%" height="40" horizontalAlign="center" gap="10" verticalAlign="middle">
			<s:Button id="okAssess" enabled="{allGood}" color="#333333" label="{resourceManager.getString('resources', 'ASSESS_PORTFOLIO')}" click="clickHandler(index.LEFT_DIRECTION, index.STACK_PORTFOLIO_PANEL)" />
		</s:HGroup>
	</s:VGroup>
</s:NavigatorContent>
