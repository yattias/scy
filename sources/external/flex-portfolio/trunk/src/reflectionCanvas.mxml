<?xml version="1.0" encoding="utf-8"?>
<s:NavigatorContent xmlns:fx="http://ns.adobe.com/mxml/2009" 
		   xmlns:s="library://ns.adobe.com/flex/spark" 
		   xmlns:mx="library://ns.adobe.com/flex/mx" creationComplete="navigatorcontent1_creationCompleteHandler(event)">
	
	<fx:Declarations>
		<s:Fade id="fadeInIm" alphaFrom="0" alphaTo="1" duration="1000" />
		<s:Fade id="fadeOutIm" alphaFrom="1" alphaTo="0" duration="1000" />
		
		<mx:StringValidator id="validateDescription" source="{descriptionArea}" property="text" triggerEvent=""
							minLength="5" tooShortError="{resourceManager.getString('resources', 'VALIDATOR_TOO_SHORT_ERROR')}"
							requiredFieldError="{resourceManager.getString('resources', 'REQUIRED_DESCRIPTION_ERROR')}"/>
	
		<s:HTTPService id="goalService" 
					   showBusyCursor="true" 
					   result="goalService_resultHandler(event)" 
					   fault="goalService_faultHandler(event)"
					   resultFormat="e4x"/>
		
		<s:HTTPService id="URLpropertyFile" 
					   showBusyCursor="true" 
					   result="URLpropertyFile_resultHandler(event)" 
					   fault="URLpropertyFile_faultHandler(event)"
					   resultFormat="e4x"/>
	</fx:Declarations>
	
	<fx:Script>
		<![CDATA[
			import adobe.utils.XMLUI;
			
			import flash.utils.clearInterval;
			import flash.utils.setInterval;
			
			import listeners.ImageMagEvent;
			import listeners.ToggleEvent;
			
			import mx.collections.ArrayCollection;
			import mx.collections.ArrayList;
			import mx.controls.Alert;
			import mx.core.FlexGlobals;
			import mx.events.FlexEvent;
			import mx.events.ValidationResultEvent;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			
			import utils.AutoSaveService;
			import utils.XMLUtilJer;
			
			[Bindable] private var slgSelectVisible:Boolean = false;
			[Bindable] private var glgSelectVisible:Boolean = false;
			
			[Bindable] private var eloUri:String = "";
			[Bindable] private var selectedEloCatname:String = "";
			[Bindable] private var elotypeTextText:String = "";
			[Bindable] private var elonameTextText:String = "";
			[Bindable] private var createdDateTextText:String = "";
			[Bindable] private var eloIconSource:String = "";
			[Bindable] private var missionTextText:String = "";
			[Bindable] private var createdTextText:String = "";
			[Bindable] private var reflectionAreaTextText:String = "";
			[Bindable] private var descriptionAreaTextText:String = "";
			[Bindable] private var glgLiveText:String = "";
			[Bindable] private var slgLiveText:String = "";
			
			private var retrievedReflectionQuestion:String = null;
			
			[Bindable] private var GLG:ArrayCollection;
			[Bindable] private var SLG:ArrayCollection;
			
			private var slectedSLGs:ArrayCollection = new ArrayCollection();
			private var slectedGLGs:ArrayCollection = new ArrayCollection();
			
			private var so:SharedObject;
			private var tEvent:ToggleEvent;
			
			protected function clickHandler(dir:String, stack:Number, but:Boolean):void {
				tEvent = new ToggleEvent(index.TOGGLE_COMMAND, true);
				tEvent.direction = dir;
				tEvent.selecTarget = stack;
				
				if(but) {
					var descValidation:ValidationResultEvent = validateDescription.validate();
										
					if (descValidation.type == ValidationResultEvent.VALID 
						&& reflectionArea.text != retrievedReflectionQuestion
						&& slectedGLGs.length > 0
						&& slectedSLGs.length > 0 ) {
						
						
						var resultToSave:Object = new Object();
						resultToSave.uri = eloUri;
						resultToSave.createdby = createdTextText;
						resultToSave.catname = selectedEloCatname;
						resultToSave.thumbnail = eloIconSource;
						resultToSave.fullsize = eloIconSource;
						resultToSave.customname = elonameTextText;
						resultToSave.modified = createdDateTextText;
						resultToSave.studentdescription = descriptionArea.text;
						resultToSave.slectedGLGs = slectedGLGs;
						resultToSave.slectedSLGs = slectedSLGs;
						resultToSave.studentreflection = reflectionArea.text;
						resultToSave.hasbeenreflectedon = false;
						resultToSave.hasbeenselectedforsubmit = false;
						resultToSave.inquiryquestion = refOnInqText.text;
						resultToSave.studentinquiry = new String(refOnInqTextSlider.value);
						resultToSave.technicalformat = selectedElo.technicalformat;
						resultToSave.rawdataid = selectedElo.rawdataid;
						resultToSave.rawdatatext = selectedElo.rawdatatext;
						resultToSave.rawdatathumb = selectedElo.rawdatathumb;
						resultToSave.rawdatafull = selectedElo.rawdatafull;
						resultToSave.rawdatadataset = selectedElo.rawdatadataset;
						
						var so:SharedObject = SharedObject.getLocal(index.SHAREDOBJECT_LOCAL_NAME);
						var retrievedElosFromRoolo:XML = so.data.retrievedElosFromRoolo;
						
						var searchForExistingList:XMLList = retrievedElosFromRoolo.elos.elo.(uri == eloUri);
						var eloXML:XML = searchForExistingList[0] as XML;
						
						if(searchForExistingList.length() > 0) {
							retrievedElosFromRoolo.elos.insertChildBefore(eloXML, XMLUtilJer.getXMLFormattedELO(resultToSave));
							delete searchForExistingList[0];
						}
						else {
							retrievedElosFromRoolo.elos.appendChild(XMLUtilJer.getXMLFormattedELO(resultToSave));
						}
						
						so.data.retrievedElosFromRoolo = retrievedElosFromRoolo;
						so.flush();
						
						var myPattern:RegExp = /\#/gi; 
						var portfolioString:String = retrievedElosFromRoolo.replace(myPattern, "@");
						
						if(FlexGlobals.topLevelApplication.url.indexOf("file:///") > -1 || FlexGlobals.topLevelApplication.url.indexOf("www-data-public") > -1) {
							resetForm();
							dispatchEvent(tEvent);
						}
						else {
							
							var ass:AutoSaveService = new AutoSaveService(so.data.saveportfolio+"?missionURI="+new String(FlexGlobals.topLevelApplication.parameters.missionURI).replace("#", "@")+"&xmlContent="+encodeURI(portfolioString));	
							ass.httpService.addEventListener(ResultEvent.RESULT, assResult);
							ass.httpService.addEventListener(FaultEvent.FAULT, assFault);
							ass.sendTheMofo();
						}
					}
					else if(reflectionArea.text == retrievedReflectionQuestion) {
						Alert.show(resourceManager.getString('resources', 'REQUIRED_REFLECTION_ERROR'), "ERROR");
					}
					else if(slectedGLGs.length == 0) {
						Alert.show(resourceManager.getString('resources', 'GLG_SELECT_ERROR'), resourceManager.getString('resources', 'GLG_SELECT_ERROR_TITLE'));
					}
					else if(slectedSLGs.length == 0) {
						Alert.show(resourceManager.getString('resources', 'SLG_SELECT_ERROR'), resourceManager.getString('resources', 'SLG_SELECT_ERROR_TITLE'));
					}
				}
				else {
					tEvent.newSearch = false;
					var sLogger:Dictionary = new Dictionary();
					sLogger["tool"] = index.SHAREDOBJECT_LOCAL_NAME;
					sLogger["type"] = "reflection_on_elo_canceled";
					sLogger["elouri"] = new String(FlexGlobals.topLevelApplication.parameters.missionURI);
					
					try {
						new AutoSaveService(so.data.actionlogger+"?&logaction="+encodeURI(XMLUtilJer.getXMLActionLoggerObject(sLogger, null)));
					}
					catch(errObject:Error) {
						trace(errObject.message);
					}
					dispatchEvent(tEvent);
				}
			}
			
			private function assResult(evt:ResultEvent):void {
				resetForm();
				dispatchEvent(tEvent);
				
				var sLogger:Dictionary = new Dictionary();
				sLogger["tool"] = index.SHAREDOBJECT_LOCAL_NAME;
				sLogger["type"] = "reflection_on_elo_finished";
				sLogger["elouri"] = new String(FlexGlobals.topLevelApplication.parameters.missionURI);
				var attribs:ArrayCollection = new ArrayCollection();
				var ob:Object = new Object();
				ob.oName = "eloReflectedOn";
				ob.oVal = eloUri;
				attribs.addItem(ob);
				new AutoSaveService(so.data.actionlogger+"?&logaction="+encodeURI(XMLUtilJer.getXMLActionLoggerObject(sLogger, attribs)));
			}
			
			private function assFault(evt:FaultEvent):void {
				
				Alert.show(evt.fault+"\nsomething f**ked up when posting the portfolio with URL:\n"+so.data.saveportfolio+"?missionURI="+FlexGlobals.topLevelApplication.parameters.missionURI, "Portfolio post error");
			}


			private function resetForm():void {
				descriptionArea.text = "";

				for(var i:Number=0; i < GLG.length; i++) {
					GLG[i].shouldAdd = false;
					
				}
				for(var j:Number=0; j < SLG.length; j++) {
					SLG[j].shouldAdd = false;
					
				}
				reflectionArea.text = "";
				
				updateSLGField();
				updateGLGField();
			}
			
			private var selectedElo:Object;
			
			public function refreshContent(edit:Boolean):void {
				currentState = "newReflection";
				so = SharedObject.getLocal(index.SHAREDOBJECT_LOCAL_NAME);
				selectedElo = so.data.searchSelection;
				
				var sLogger:Dictionary = new Dictionary();
				sLogger["tool"] = index.SHAREDOBJECT_LOCAL_NAME;
				sLogger["type"] = "reflection_on_elo_started";
				sLogger["elouri"] = new String(FlexGlobals.topLevelApplication.parameters.missionURI);
				var attribs:ArrayCollection = new ArrayCollection();
				var ob:Object = new Object();
				ob.oName = "eloReflectedOn";
				ob.oVal = selectedElo.uri;
				attribs.addItem(ob);
				new AutoSaveService(so.data.actionlogger+"?&logaction="+encodeURI(XMLUtilJer.getXMLActionLoggerObject(sLogger, attribs)));
				
				if(selectedElo != null) {
					selectedEloCatname = selectedElo.catname;
					missionTextText = index.MISSION_NAME + " / " + selectedEloCatname;
					createdTextText = selectedElo.createdby;
					if(selectedElo.thumbnail != null ||Â selectedElo.thumbnail != "") {
						eloIconSource = selectedElo.thumbnail;
					}
					else {
						eloIconSource = index.NOTHUMB;
					}
					eloIcon.source = eloIconSource;
					
					elonameTextText = selectedElo.customname;
					createdDateTextText = selectedElo.modified;
					
					var myPattern:RegExp = /#/gi; 
					if(edit) {
						
						eloUri = (selectedElo.uri).replace(myPattern, "@");
						currentState = "updateReflection";
						descriptionArea.text = selectedElo.studentdescription;
						
						for(var i:Number = 0; i<(selectedElo.studentglg as ArrayCollection).length; i++) {
							var n:Number = new Number((selectedElo.studentglg as ArrayCollection)[i][0].pos);
							GLG[n].shouldAdd = true;
						}
						updateGLGField();
						
						for(var j:Number = 0; j<(selectedElo.studentslg as ArrayCollection).length; j++) {
							var m:Number = new Number((selectedElo.studentslg as ArrayCollection)[j][0].pos);
							SLG[m].shouldAdd = true;
						}
						updateSLGField();
						
						reflectionArea.text = selectedElo.studentreflection;
						refOnInqTextSlider.value = new Number(selectedElo.studentinquiry);
					}
					else {
						selectedElo = XMLUtilJer.getXMLAsEloObject(selectedElo as XML);
						eloUri = (selectedElo.uri).replace(myPattern, "@");
						
						for (var k:int = 0; k < index.obligElos.length; k++) {
							if(selectedEloCatname == (index.obligElos[k]).label) {
								retrievedReflectionQuestion = (index.obligElos[k]).refquest;
								reflectionAreaTextText = retrievedReflectionQuestion;
							}
						}
					}
				}
				else {
					Alert.show(resourceManager.getString('resources', 'SEARCH_PROPERTY_FILE_ERROR'), resourceManager.getString('resources', 'HTTP_SERVICE_ERROR'));
				}
						//place the question
				
				
			}


			protected function button1_clickHandler(b:Boolean):void
			{
				slgSelect.visible = b;
				
				if(!b) {
					updateSLGField();
				}
			}
			
			protected function button2_clickHandler(b:Boolean):void
			{
				glgSelect.visible = b;
				
				if(!b) {
					updateGLGField();
				}
			}
			
			private function updateSLGField():void {
				slectedSLGs = new ArrayCollection();
				for(var i:Number = 0; i<SLG.length; i++) {
					if(SLG[i].shouldAdd) {
						slectedSLGs.addItem([{entry:SLG[i].goal, pos:i}]);
					}
				}
				
				if(slectedSLGs.length > 0) {
					slgLiveText = slectedSLGs.length + " " + resourceManager.getString('resources', 'SLG').toLowerCase() + " " + (resourceManager.getString('resources', 'SELECTED')).toLowerCase();
				}
				else {
					slgLiveText = "";	
				}
				
				SLG.refresh();
				slgResultGrid.validateNow();
			}
			
			private function updateGLGField():void {
				slectedGLGs = new ArrayCollection();
				for(var i:Number = 0; i<GLG.length; i++) {
					if(GLG[i].shouldAdd) {
						slectedGLGs.addItem([{entry:GLG[i].goal, pos:i}]);
					}
				}
				
				if(slectedGLGs.length > 0) {
					glgLiveText = slectedGLGs.length + " " + resourceManager.getString('resources', 'GLG').toLowerCase() + " " + (resourceManager.getString('resources', 'SELECTED')).toLowerCase();
				}
				else {
					glgLiveText = "";	
				}
				
				GLG.refresh();
				glgResultGrid.validateNow();
			}


			protected function navigatorcontent1_creationCompleteHandler(event:FlexEvent):void {
				var so:SharedObject = SharedObject.getLocal(index.SHAREDOBJECT_LOCAL_NAME);
				
				URLpropertyFile.url = FlexGlobals.topLevelApplication.parameters.toolURLProvider;
				if(FlexGlobals.topLevelApplication.url.indexOf("file:///") > -1 || FlexGlobals.topLevelApplication.url.indexOf("www-data-public") > -1) {
					URLpropertyFile.url = "xml/toolURLProvider.html";
				}
				URLpropertyFile.send();
			}


			protected function goalService_resultHandler(event:ResultEvent):void {
				var xml:XML= event.result as XML;
				var xmlObject:Object;
				GLG = new ArrayCollection();
				SLG = new ArrayCollection();
				
				for each (var object:XML in xml.generalLearningGoals.*) {
					if (object.name() == "learninggoal") {
						xmlObject = new Object();
						xmlObject.goal = object.goal[0].text();
						xmlObject.shouldAdd = false;
						GLG.addItem(xmlObject);
					}
				}
				
				for each (var object:XML in xml.specificLearningGoals.*) {
					if (object.name() == "learninggoal") {
						xmlObject = new Object();
						xmlObject.goal = object.goal[0].text();
						xmlObject.shouldAdd = false;
						SLG.addItem(xmlObject);
					}
				}
			}


			protected function goalService_faultHandler(event:FaultEvent):void {
				Alert.show(resourceManager.getString('resources', 'GOAL_PROPERTY_FILE_ERROR'), resourceManager.getString('resources', 'HTTP_SERVICE_ERROR'));
			}


			protected function URLpropertyFile_resultHandler(event:ResultEvent):void {
				var toolURLProvider:XML= event.result as XML;
				goalService.url = new String(toolURLProvider.learninggoalsloader)+"?missionURI="+decodeURI(new String(FlexGlobals.topLevelApplication.parameters.missionURI)).replace("#", "%23");
				if(FlexGlobals.topLevelApplication.url.indexOf("file:///") > -1 || FlexGlobals.topLevelApplication.url.indexOf("www-data-public") > -1) {
					goalService.url = new String(toolURLProvider.learninggoalsloader).substring(1)+"?missionURI="+decodeURI(FlexGlobals.topLevelApplication.parameters.missionURI).replace("#", "%23");
				}
				
				goalService.send();
			}


			protected function URLpropertyFile_faultHandler(event:FaultEvent):void {
				Alert.show(resourceManager.getString('resources', 'URL_PROPERTY_FILE_ERROR'), resourceManager.getString('resources', 'HTTP_SERVICE_ERROR'));
			}
			
			protected function image1_clickHandler(event:MouseEvent):void {
				//disbaled for the time being
				/*var tEvent:ImageMagEvent = new ImageMagEvent(index.IMAGEMAG_COMMAND, true);
				tEvent.showNow = true;
				if((so.data.searchSelection as XML).technicalformat == "scy/rtf") {
					tEvent.evtType = index.ZOOM_TYPE_RICHTEXT;
					tEvent.rtf = ((so.data.searchSelection as XML).rawdata.text).toString();
				}
				else if((so.data.searchSelection as XML).technicalformat == "scy/model") {
					tEvent.evtType = index.ZOOM_TYPE_IMAGE;
					tEvent.imageSource = ((so.data.searchSelection as XML).rawdata.fullscreen).toString();
				}
				else if((so.data.searchSelection as XML).technicalformat == "scy/pds") {
					tEvent.evtType = index.ZOOM_TYPE_IMAGE;
					tEvent.imageSource = ((so.data.searchSelection as XML).rawdata.fullscreen).toString();
				}
				else if((so.data.searchSelection as XML).technicalformat == "scy/xproc") {
					tEvent.evtType = index.ZOOM_TYPE_IMAGE;
					tEvent.imageSource = ((so.data.searchSelection as XML).rawdata.fullscreen).toString();
				}
				else if((so.data.searchSelection as XML).technicalformat == "scy/xproc") {
					tEvent.evtType = index.ZOOM_TYPE_IMAGE;
					tEvent.imageSource = ((so.data.searchSelection as XML).rawdata.fullscreen).toString();
				}
				else {
					tEvent.evtType = index.ZOOM_TYPE_IMAGE;
					tEvent.imageSource = ((so.data.searchSelection as XML).rawdata.fullscreen).toString();
				}
				
				dispatchEvent(tEvent);*/
			}
			
			protected function image1_ioErrorHandler(event:IOErrorEvent):void {
				switch(event.errorID) {
					case 0:
						eloIconSource = index.NOTHUMB;
						break;
				}
			}

		]]>
	</fx:Script>
	
	<s:states>
		<s:State name="newReflection" />
		<s:State name="updateReflection" />
	</s:states>
	
	<s:VGroup width="100%" height="100%">
		<s:BorderContainer id="reflectionHeader" width="100%" height="140" backgroundColor="{index.THEME_COL}" borderStyle="solid" borderColor="{index.THEME_COL}">
			<s:BorderContainer width="100" height="100" x="15" y="20" borderVisible="false" dropShadowVisible="true">
				<s:Image id="eloIcon" source="{eloIconSource}" width="100" height="100" buttonMode="true" toolTip="{resourceManager.getString('resources', 'DISPLAY_ZOOM')}" ioError="image1_ioErrorHandler(event)" click="image1_clickHandler(event)" />
			</s:BorderContainer>
			
			<mx:Form x="{eloIcon.x+eloIcon.width+30}" y="0" verticalGap="0" color="{index.BACK_GRADIENT_BOT}" fontSize="13">
				<mx:FormItem label="{resourceManager.getString('resources', 'MISSION')+' / '+resourceManager.getString('resources', 'ELO_NAME')+':'}">
					<mx:Label id="missionText" text="{missionTextText}" width="100%" />
				</mx:FormItem>
				
				<mx:FormItem label="{resourceManager.getString('resources', 'ELO_TYPE')+':'}">
					<mx:Label id="elotypeText" text="{elotypeTextText}"/>
				</mx:FormItem>
				
				<mx:FormItem label="{resourceManager.getString('resources', 'ELO_FILENAME')+':'}">
					<mx:Label id="elonameText" text="{elonameTextText}"/>
				</mx:FormItem>
				
				<mx:FormItem label="{resourceManager.getString('resources', 'CREATED_BY')+':'}">
					<mx:Label id="createdText" text="{createdTextText}"/>
				</mx:FormItem>
				
				<mx:FormItem label="{resourceManager.getString('resources', 'CREATED_DATE')+':'}">
					<mx:Label id="createdDateText" text="{createdDateTextText}"/>
				</mx:FormItem>
			</mx:Form>
		</s:BorderContainer>
		<s:BorderContainer width="{reflectionHeader.width}" minHeight="10">
			<s:HGroup left="2" top="2" right="2" bottom="2" verticalAlign="middle">
				<s:Image source="{index.IMAGE_BASE_URL+'assets/images/inf.png'}" width="10" height="10" />
				<s:Label id="instruc" width="100%" height="13" text="{resourceManager.getString('resources', 'REFLEC_RESULT_INSTRUC')}" verticalAlign="middle" />
			</s:HGroup>
		</s:BorderContainer>
		<s:VGroup id="refForm" width="100%" height="100%" horizontalAlign="center">
			<mx:Form verticalGap="7" color="{index.THEME_COL}" fontSize="14">
				<mx:FormItem label="{resourceManager.getString('resources', 'DESCRIPTION')+':'}" required="true">
					<s:TextArea width="400" height="80" id="descriptionArea" text="{descriptionAreaTextText}" color="#000000"/>
				</mx:FormItem>
				
				<mx:FormItem label="{resourceManager.getString('resources', 'GLG')+':'}" required="true">
					<mx:HBox width="100%">
						<s:Button click="button2_clickHandler(true)" color="#000000" label="{resourceManager.getString('resources', 'GLG_SELECT')}"/>
						<mx:Text id="glgLive" color="{index.THEME_COL}" text="{glgLiveText}" fontSize="11" />
					</mx:HBox>
				</mx:FormItem>
				
				<mx:FormItem label="{resourceManager.getString('resources', 'SLG')+':'}" required="true">
					<mx:HBox width="100%">
						<s:Button click="button1_clickHandler(true)" color="#000000" label="{resourceManager.getString('resources', 'SLG_SELECT')}"/>
						<mx:Text id="slgLive" color="{index.THEME_COL}" text="{slgLiveText}" fontSize="11" />
					</mx:HBox>
				</mx:FormItem>
				
				<mx:FormItem label="{resourceManager.getString('resources', 'REFLECTION')+':'}" required="true">
					<mx:Text id="reflectionAreaText" text="{resourceManager.getString('resources', 'REFLEC_BOX_TXT')}" width="400" />
					<s:TextArea width="400" height="60" id="reflectionArea" text="{reflectionAreaTextText}" color="#000000"/>
				</mx:FormItem>
				
				<mx:FormItem label="{resourceManager.getString('resources', 'REF_ON_INQ')+':'}">
					<mx:VBox width="100%" verticalGap="0">
						<mx:Text id="refOnInqText" text="{index.REF_ON_INQ_TXT}" width="400" />
						<mx:HBox width="400" height="33" horizontalGap="{(400-4*30)/3}">
							<mx:Image id="thummmmmm1" source="{index.IMAGE_BASE_URL+'assets/images/emoticons/1.png'}" width="30" height="33" />
							<mx:Image source="{index.IMAGE_BASE_URL+'assets/images/emoticons/2.png'}" width="30" height="33" />
							<mx:Image source="{index.IMAGE_BASE_URL+'assets/images/emoticons/3.png'}" width="30" height="33" />
							<mx:Image source="{index.IMAGE_BASE_URL+'assets/images/emoticons/4.png'}" width="30" height="33" />
						</mx:HBox>
						<mx:HSlider id="refOnInqTextSlider" minimum="1" maximum="4" value="2" dataTipPlacement="top" tickColor="0x323232"
									snapInterval="1" tickInterval="1" allowTrackClick="true" width="400" showDataTip="false"/>
					</mx:VBox>
				</mx:FormItem>
			</mx:Form>
		</s:VGroup>
		<s:HGroup id="reflectionFooter" width="100%" height="40" horizontalAlign="center" gap="10" verticalAlign="middle">
			<s:Button id="okReflect" label="{resourceManager.getString('resources', 'FINISHED_BUTTON')}" click="clickHandler(index.RIGHT_DIRECTION, index.STACK_INTRO_PANEL, true)" excludeFrom="updateReflection"/>
			<s:Button id="cancelReflect" label="{resourceManager.getString('resources', 'CANCEL_BUTTON')}" click="clickHandler(index.RIGHT_DIRECTION, index.STACK_SEARCH_PANEL, false)" excludeFrom="updateReflection"/>
			<s:Button id="updateReflect" label="{resourceManager.getString('resources', 'UPDATE_BUTTON')}" click="clickHandler(index.RIGHT_DIRECTION, index.STACK_INTRO_PANEL, true)" excludeFrom="newReflection"/>
		</s:HGroup>
	</s:VGroup>
	<s:BorderContainer id="glgSelect" visible="false" alpha="0" showEffect="{fadeInIm}" hideEffect="{fadeOutIm}" width="100%" height="100%" backgroundColor="#000000" backgroundAlpha=".7" cornerRadius="0">
		<s:BorderContainer id="glgSelect1" y="{refForm.y}" top="20" left="20" right="20" bottom="20" backgroundColor="{index.BACK_GRADIENT_TOP}" borderColor="{index.THEME_COL}" backgroundAlpha=".9" cornerRadius="10" borderWeight="2">
			<s:Scroller top="20" left="20" right="20" bottom="40">
				<s:VGroup width="100%" height="100%">
					<mx:DataGrid id="glgResultGrid" width="100%" height="100%" dataProvider="{GLG}" variableRowHeight="true">
						<mx:columns>
							<mx:DataGridColumn dataField="goal" headerText="{resourceManager.getString('resources', 'GLG')}" wordWrap="true" width="450" />
							<mx:DataGridColumn id="gcol2"
											   editorDataField="selected"
											   rendererIsEditor="true"
											   dataField="data.shouldAdd"
											   headerText="Selection">
								<mx:itemRenderer>
									<fx:Component>
										<mx:CheckBox selected="{data.shouldAdd}"
													 change="data.shouldAdd=selected" textAlign="center"/>
									</fx:Component>
								</mx:itemRenderer>
							</mx:DataGridColumn>
						</mx:columns>
					</mx:DataGrid>
				</s:VGroup>
			</s:Scroller>
			<s:HGroup id="glgSelectFooter" width="100%" height="40" bottom="0" horizontalAlign="center" gap="10" verticalAlign="middle">
				<s:Button id="okglgSelect" label="{resourceManager.getString('resources', 'OK_BUTTON')}" click="button2_clickHandler(false)" />
			</s:HGroup>
		</s:BorderContainer>
	</s:BorderContainer>
	<s:BorderContainer id="slgSelect" visible="false" alpha="0" showEffect="{fadeInIm}" hideEffect="{fadeOutIm}" width="100%" height="100%" backgroundColor="#000000" backgroundAlpha=".7" cornerRadius="0">
		<s:BorderContainer id="slgSelect1" y="{refForm.y}" top="10" left="20" right="20" bottom="20" backgroundColor="{index.BACK_GRADIENT_TOP}" borderColor="{index.THEME_COL}" backgroundAlpha=".9" cornerRadius="10" borderWeight="2">
			<s:Scroller top="20" left="20" right="20" bottom="40">
				<s:VGroup width="100%" height="100%">
					<mx:DataGrid id="slgResultGrid" width="100%" height="100%" dataProvider="{SLG}" variableRowHeight="true">
						<mx:columns>
							<mx:DataGridColumn dataField="goal" headerText="{resourceManager.getString('resources', 'SLG')}" wordWrap="true" width="450" />
							<mx:DataGridColumn id="scol2"
											   editorDataField="selected"
											   rendererIsEditor="true"
											   dataField="data.shouldAdd"
											   headerText="Selection">
								<mx:itemRenderer>
									<fx:Component>
										<mx:CheckBox selected="{data.shouldAdd}"
													 change="data.shouldAdd=selected" textAlign="center"/>
									</fx:Component>
								</mx:itemRenderer>
							</mx:DataGridColumn>
						</mx:columns>
					</mx:DataGrid>
				</s:VGroup>
			</s:Scroller>
			<s:HGroup id="slgSelectFooter" width="100%" height="40" bottom="0" horizontalAlign="center" gap="10" verticalAlign="middle">
				<s:Button id="okslgSelect" label="{resourceManager.getString('resources', 'OK_BUTTON')}" click="button1_clickHandler(false)" />
			</s:HGroup>
		</s:BorderContainer>
	</s:BorderContainer>
</s:NavigatorContent>
