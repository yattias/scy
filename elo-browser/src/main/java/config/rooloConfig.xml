<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<alias name="localRepository" alias="repository"/>
	<alias name="localMetadataTypeManager" alias="metadataTypeManager"/>
	<alias name="localExtensionManager" alias="extensionManager"/>

<!--
	<alias name="httpInvokerRepositoryProxy" alias="repository"/>
	<alias name="httpInvokerMetadataTypeManagerProxy" alias="metadataTypeManager"/>
	<alias name="httpInvokerExtensionManagerProxy" alias="extensionManager"/>
-->

	<!-- Resolves ${...} placeholders from client.properties -->
	<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="location"><value>client.properties</value></property>
	</bean>

	<!-- Proxy for the HTTP-invoker-exported repository -->
	<!-- Spring's HTTP invoker uses Java serialization via HTTP  -->
	<bean id="httpInvokerRepositoryProxy" class="org.springframework.remoting.httpinvoker.HttpInvokerProxyFactoryBean">
		<property name="serviceUrl">
			<value>http://${serverName}:${httpPort}${contextPath}/remoting/repository-httpinvoker</value>
		</property>
		<property name="serviceInterface">
			<value>roolo.api.IRepository</value>
		</property>
		<!--
		Comment the following in to use Apache Commons HttpClient instead of the JDK's
		standard HttpURLConnection (as used by the default SimpleHttpInvokerRequestExecutor).
		-->
		<!--
		<property name="httpInvokerRequestExecutor">
			<bean class="org.springframework.remoting.httpinvoker.CommonsHttpInvokerRequestExecutor"/>
		</property>
 		-->
	</bean>

	<!-- Proxy for the HTTP-invoker-exported metadata type manager -->
	<!-- Spring's HTTP invoker uses Java serialization via HTTP  -->
	<bean id="httpInvokerMetadataTypeManagerProxy" class="org.springframework.remoting.httpinvoker.HttpInvokerProxyFactoryBean">
		<property name="serviceUrl">
			<value>http://${serverName}:${httpPort}${contextPath}/remoting/metadataTypeManager-httpinvoker</value>
		</property>
		<property name="serviceInterface">
			<value>roolo.elo.api.IMetadataTypeManager</value>
		</property>
		<!--
		Comment the following in to use Apache Commons HttpClient instead of the JDK's
		standard HttpURLConnection (as used by the default SimpleHttpInvokerRequestExecutor).
		-->
		<!--
		<property name="httpInvokerRequestExecutor">
			<bean class="org.springframework.remoting.httpinvoker.CommonsHttpInvokerRequestExecutor"/>
		</property>
 		-->
	</bean>

	<!-- Proxy for the HTTP-invoker-exported extension manager -->
	<!-- Spring's HTTP invoker uses Java serialization via HTTP  -->
	<bean id="httpInvokerExtensionManagerProxy" class="org.springframework.remoting.httpinvoker.HttpInvokerProxyFactoryBean">
		<property name="serviceUrl">
			<value>http://${serverName}:${httpPort}${contextPath}/remoting/extensionManager-httpinvoker</value>
		</property>
		<property name="serviceInterface">
			<value>roolo.api.IExtensionManager</value>
		</property>
		<!--
		Comment the following in to use Apache Commons HttpClient instead of the JDK's
		standard HttpURLConnection (as used by the default SimpleHttpInvokerRequestExecutor).
		-->
		<!--
		<property name="httpInvokerRequestExecutor">
			<bean class="org.springframework.remoting.httpinvoker.CommonsHttpInvokerRequestExecutor"/>
		</property>
 		-->
	</bean>

	<bean name="localRepository" class="roolo.cms.repository.mock.MockRepository">
		<property name="metadataTypeManager" ref="localMetadataTypeManager"/>
		<property name="extensionManager" ref="localExtensionManager"/>
		<property name="eloStoreDirectory" value="eloStore"/>
		<property name="storeElosInStoreDirectory" value="true"/>
	</bean>

	<bean name="localMetadataTypeManager" class="roolo.cms.repository.mock.MockMetadataTypeManager">
		<property name="metadataKeys">
			<list>
				<ref bean="uriKey"/>
				<ref bean="titleKey"/>
				<ref bean="descriptionKey"/>
				<ref bean="formatKey"/>
				<ref bean="dateCreatedKey"/>
				<ref bean="dateLastModifiedKey"/>
				<ref bean="missionKey"/>
				<ref bean="authorKey"/>

				<ref bean="lineCountKey"/>
				<ref bean="rectangleCountKey"/>
				<ref bean="ovalCountKey"/>
				<ref bean="freehandCountKey"/>
				<ref bean="textCountKey"/>
				<ref bean="imageCountKey"/>
				<ref bean="tagPointerCountKey"/>

				<ref bean="testStringListKey"/>
			</list>
		</property>
	</bean>

	<bean name="uriKey" class="roolo.elo.metadata.keys.UriMetadataKey">
		<constructor-arg index="0" value="uri"/>
		<constructor-arg index="1" value="/lom/general/identifier"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultUriValidator"/>
	</bean>
	<bean name="titleKey" class="roolo.elo.metadata.keys.StringMetadataKey">
		<constructor-arg index="0" value="title"/>
		<constructor-arg index="1" value="/lom/general/title"/>
		<constructor-arg index="2" value="SPECIFIC"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultStringValidator"/>
	</bean>
	<bean name="descriptionKey" class="roolo.elo.metadata.keys.StringMetadataKey">
		<constructor-arg index="0" value="description"/>
		<constructor-arg index="1" value="/lom/general/description"/>
		<constructor-arg index="2" value="SPECIFIC"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultStringValidator"/>
	</bean>
	<bean name="formatKey" class="roolo.elo.metadata.keys.StringMetadataKey">
		<constructor-arg index="0" value="type"/>
		<constructor-arg index="1" value="/lom/technical/format"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultStringValidator"/>
	</bean>
	<bean name="dateCreatedKey" class="roolo.elo.metadata.keys.LongMetadataKey">
		<constructor-arg index="0" value="dateCreated"/>
		<constructor-arg index="1" value="/lom/technical/customElements/dateCreated"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultLongValidator"/>
	</bean>
	<bean name="dateLastModifiedKey" class="roolo.elo.metadata.keys.LongMetadataKey">
		<constructor-arg index="0" value="dateLastModified"/>
		<constructor-arg index="1" value="/lom/technical/customElements/dateLastModified"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultLongValidator"/>
	</bean>
	<bean name="missionKey" class="roolo.elo.metadata.keys.RelationMetadataKey">
		<constructor-arg index="0" value='mission'/>
		<constructor-arg index="1" value='/lom/relation/[kind="isbasedon",type="scy/mission"]'/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultUriValidator"/>
	</bean>
	<bean name="authorKey" class="roolo.elo.metadata.keys.ContributeMetadataKey">
		<constructor-arg index="0" value='author'/>
		<constructor-arg index="1" value='/lom/lifecycle/contribute/[kind="author"]'/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="LIST"/>
		<constructor-arg index="4" ref="defaultContributeValidator"/>
	</bean>

	<bean name="testStringListKey" class="roolo.elo.metadata.keys.StringMetadataKey">
		<constructor-arg index="0" value='testStringList'/>
		<constructor-arg index="1" value='/test/list'/>
		<constructor-arg index="2" value="SPECIFIC"/>
		<constructor-arg index="3" value="LIST"/>
		<constructor-arg index="4" ref="defaultStringValidator"/>
	</bean>

	<bean name="lineCountKey" class="roolo.elo.metadata.keys.LongMetadataKey">
		<constructor-arg index="0" value="lineCount"/>
		<constructor-arg index="1" value="/lom/agentData/draw/lineCount"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultLongValidator"/>
	</bean>
	<bean name="rectangleCountKey" class="roolo.elo.metadata.keys.LongMetadataKey">
		<constructor-arg index="0" value="rectangleCount"/>
		<constructor-arg index="1" value="/lom/agentData/draw/rectangleCount"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultLongValidator"/>
	</bean>
	<bean name="ovalCountKey" class="roolo.elo.metadata.keys.LongMetadataKey">
		<constructor-arg index="0" value="ovalCount"/>
		<constructor-arg index="1" value="/lom/agentData/draw/ovalCount"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultLongValidator"/>
	</bean>
	<bean name="freehandCountKey" class="roolo.elo.metadata.keys.LongMetadataKey">
		<constructor-arg index="0" value="freehandCount"/>
		<constructor-arg index="1" value="/lom/agentData/draw/freehandCount"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultLongValidator"/>
	</bean>
	<bean name="textCountKey" class="roolo.elo.metadata.keys.LongMetadataKey">
		<constructor-arg index="0" value="textCount"/>
		<constructor-arg index="1" value="/lom/agentData/draw/textCount"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultLongValidator"/>
	</bean>
	<bean name="imageCountKey" class="roolo.elo.metadata.keys.LongMetadataKey">
		<constructor-arg index="0" value="imageCount"/>
		<constructor-arg index="1" value="/lom/agentData/draw/imageCount"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultLongValidator"/>
	</bean>
	<bean name="tagPointerCountKey" class="roolo.elo.metadata.keys.LongMetadataKey">
		<constructor-arg index="0" value="tagPointerCount"/>
		<constructor-arg index="1" value="/lom/agentData/draw/tagPointerCount"/>
		<constructor-arg index="2" value="UNIVERSAL"/>
		<constructor-arg index="3" value="SINGLE"/>
		<constructor-arg index="4" ref="defaultLongValidator"/>
	</bean>

	<bean name="defaultStringValidator" class="roolo.elo.metadata.value.validators.StringValidator"></bean>

	<bean name="defaultLongValidator" class="roolo.elo.metadata.value.validators.LongValidator"></bean>

	<bean name="defaultUriValidator" class="roolo.elo.metadata.value.validators.UriValidator"></bean>

	<bean name="defaultContributeValidator" class="roolo.elo.metadata.value.validators.ContributeValidator"></bean>

	<bean name="localExtensionManager" class="roolo.cms.repository.mock.MockExtensionManager">
		<property name="extensions">
			<map>
				<entry>
					<key>
						<value>scy/drawing</value>
					</key>
					<value>.scydraw</value>
				</entry>
				<entry>
					<key>
						<value>scy/eloBrowser/metadataDisplayMapping</value>
					</key>
					<value>.selomap</value>
				</entry>
			</map>
		</property>
	</bean>
	
	<bean name="searchOperations" class="roolo.cms.repository.search.BasicSearchOperationNames">
	</bean>

	<bean name="jdomBasicELOFactory" class="roolo.elo.JDomBasicELOFactory">
		<constructor-arg ref="metadataTypeManager"/>
	</bean>
	<alias name="jdomBasicELOFactory" alias="eloFactory"/>
	
	<bean name="xmlMetadataDisplayMappingConverter" class="eu.scy.elobrowser.model.mapping.impl.JDomXmlMetadataDisplayMappingConverter">
		<property name="metadataTypeManager" ref="metadataTypeManager"/>
	</bean>
	
	<bean name="mappingEloFactory" class="eu.scy.elobrowser.model.mapping.impl.BasicMappingEloFactory">
		<property name="xmlMetadataDisplayMappingConverter" ref="xmlMetadataDisplayMappingConverter"/>
		<property name="metadataTypeManager" ref="metadataTypeManager"/>
		<property name="eloFactory" ref="eloFactory"/>
		<property name="formatKey" ref="formatKey"/>
		<property name="nameKey" ref="titleKey"/>
		<property name="descriptionKey" ref="descriptionKey"/>
	</bean>

	<bean name="queryToElosDisplay" class="eu.scy.elobrowser.model.mapping.impl.BasicQueryToElosDisplay">
		<property name="repository" ref="repository"/>
	</bean>

</beans>
